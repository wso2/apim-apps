import axios from "axios";

const API_BASE_URL = "http://localhost:8080/api/vulnerabilities";

class VulnerabilityService {
  editVulnerability(vulnerabilityArray, portal, branch) {
    return axios.put(API_BASE_URL + "/" + portal + "/" + branch + "/edit", {
      vulnerabilities: vulnerabilityArray,
    });
  }

  getVulnerabilitiesByPortal(portal, branch) {
    return axios.get(API_BASE_URL + "/" + portal + "/" + branch);
  }

  getLastModifiedTime(portal, branch) {
    return axios.get(
      API_BASE_URL + "/" + portal + "/" + branch + "/fileLastModifiedTime"
    );
  }

  getBranches() {
    return axios.get(API_BASE_URL + "/fetchBranches");
  }
}

export default new VulnerabilityService();
